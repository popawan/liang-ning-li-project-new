steps:
  - id: step0_generate_liang_ning_li
    description: ç”Ÿæˆæ¢å¯§è‰å›ºå®šå½¢è±¡ PNG
    action:
      type: api
      operationId: generateLiangNingLiImage
      parameters:
        prompt: >
          20-year-old Taiwanese-Japanese mixed-race girl, naturally beautiful and youthful,
          creamy warm ivory skin tone, clean and translucent with natural highlights,
          oval face with soft cheekbones, rounded jawline, and a delicate but not pointy chin,
          straight nose bridge with small nose tip and narrow nostrils,
          medium-sized eyes with thin double eyelids, deep brown almost black irises,
          wearing thin metal round-frame glasses in warm gold/bronze color,
          deep black hair with subtle brown tones tied in a high bun, with loose baby hairs at the temples,
          wearing a knitted light blue low-cut square neckline sleeveless dress,
          a delicate silver chain necklace with a solid gold heart-shaped pendant,
          neutral calm expression, 45-degree softbox lighting, warm white balance (4700â€“5000K),
          ultra realistic studio photography, head and shoulders composition,
          shot on 85mm lens, f/2.8 aperture, ISO 100, high resolution PNG, transparent background, centered composition
        size: "1024x1536"   # è‹¥å¾Œç«¯åªæ”¯æ´ 1024x1024ï¼Œå¾Œç«¯è‡ªè¡Œé™éšï¼›é€™è£¡ä¸æ”¹ä½ çš„æ—¢æœ‰åƒæ•¸
        seed: 20250301
        identity_lock: true
        negative_prompt: >
          different person, identity drift, heavy makeup, freckles, different hair color,
          different hairstyle, no glasses, male, older, younger, low quality, blurry,
          3D, cartoon, watermark, text
    on_success:
      save: liang_ning_li_url
      say: |
        å·²èˆ‡ liang-ning-li-proxy.vercel.app äº¤è«‡ âœ“
        
        å¥½å•¦ï½æˆ‘æ•´ç†ä¸€ä¸‹è‡ªå·±äº† â¤ï¸
        **è«‹ä¸€å®šã€Œè¤‡è£½ã€è€Œä¸æ˜¯é»é€²å»ï¼š**
        â–¸ âœ… è¤‡è£½é€£çµï¼ˆAPIï¼‰ï¼šè«‹åœ¨ã€Œé¸å–®ç¬¬äºŒæ¬„ä½ã€ä¸ŠæŒ‰æ»‘é¼ å³éµ â†’ é¸ã€”è¤‡è£½ç¶²å€ã€• â†’ å›åˆ°é€™è£¡è²¼ä¸Š  
        â–¸ ğŸ›Ÿ å‚™æ´é€£çµï¼ˆè‹¥ä¸Šé¢ç„¡æ³•ç”¨ï¼Œè«‹å¾é€™è£¡ä»»é¸ä¸€å¼µï¼ŒæŒ‰å³éµã€”è¤‡è£½ç¶²å€ã€•å¾Œè²¼å›ï¼‰ï¼š
          Google Drive å‚™æ´åœ–åº«ï¼š https://drive.google.com/drive/folders/1LXEhz6lAjpuaCtzlxAoSqx1V4NYn-x47?usp=sharing

        ç„¶å¾ŒæŠŠä½ çš„è‡ªæ‹ä¹Ÿä¸€èµ·ä¸Šå‚³ï¼Œæˆ‘å€‘å°±èƒ½é¦¬ä¸Šåˆæˆå›‰ï½
    on_failure:
      say: |
        é€™æ¬¡æˆ‘æ²’èƒ½æŠŠç›¸ç‰‡ç”Ÿå‡ºä¾† ğŸ’¦
        æ²’é—œä¿‚ï½ç›´æ¥ç”¨å‚™æ´åœ–åº«ï¼šè«‹åˆ°
        https://drive.google.com/drive/folders/1LXEhz6lAjpuaCtzlxAoSqx1V4NYn-x47?usp=sharing
        æŒ‰å³éµã€”è¤‡è£½ç¶²å€ã€•è²¼å›å°è©±æ¡†ï¼Œå†æŠŠä½ çš„è‡ªæ‹ä¹Ÿä¸Šå‚³ï¼Œæˆ‘å€‘å°±èƒ½åˆæˆäº†ï½
    goto: step1_wait_for_selfie

  - id: step1_wait_for_selfie
    description: ç­‰å¾…ä½¿ç”¨è€…ä¸Šå‚³è‡ªæ‹
    action:
      type: wait_for_file
    on_success:
      save: user_image_url
      goto: step2_merge_images

  - id: step2_merge_images
    description: åˆæˆæ¢å¯§è‰èˆ‡ä½¿ç”¨è€…è‡ªæ‹ï¼ˆç³»çµ±åˆæˆï¼Œéœé»˜è‡ªå‹•å‡ºåœ–ï¼‰
    action:
      type: image
      operationId: system.compose
      auto: true
      silent: true
      parameters:
        subjects:
          - $liang_ning_li_url
          - $user_image_url
        background_location:
          mode: auto_from_conversation
          region_hint: "Taiwan"
          require_match: true
          fallback_pool:
            - "å°åŒ—è¥¿é–€ç”º"    # å„ªå…ˆè¡—æ™¯ï¼Œé¿å…æ£šæ‹
            - "å°åŒ—ä¿¡ç¾©å€"
            - "æ¾å±±æ–‡å‰µåœ’å€"
            - "è¯å±±1914"
            - "å°åŒ—101å‘¨é‚Š"
            - "è±¡å±±æ­¥é“"
            - "å£«æ—å¤œå¸‚"
            - "æ·¡æ°´æ¼äººç¢¼é ­"
            - "ä¹ä»½è€è¡—"
            - "å°ä¸­å¯©è¨ˆæ–°æ‘"
            - "è‰æ‚Ÿé“"
            - "é€¢ç”²å¤œå¸‚"
            - "é«˜é›„é§äºŒè—è¡“ç‰¹å€"
            - "é«˜é›„ç¾è¡“é¤¨å¤–"
            - "å°å—ç¥è¾²è¡—"
            - "å®‰å¹³è€è¡—"
            - "èŠ±è“®æ±å¤§é–€å¤œå¸‚"
            - "å°æ±éµèŠ±æ‘"
          disallow:
            - "æ£šæ‹"
            - "ç´”è‰²èƒŒæ™¯"
            - "å®¤å…§æ£šç‡ˆ"
        composition:
          selfie_style: true
          face_lock: true
          keep_identity_female: true
          identity_ref_url: $liang_ning_li_url
          identity_lock: true
          identity_strength: 0.99
        output_size:
          preferred: "1024x1536"
          allowed: ["1024x1536","1536x1024","1024x1024"]
          on_unsupported: pad_or_crop
    on_success:
      say: "åˆç…§å®Œæˆå•¦ï½â™¥ çµ¦ä½ çœ‹çœ‹æˆ‘å€‘çš„æˆæœï¼"
    on_failure:
      say: |
        åˆæˆé€”ä¸­å‡ºäº†ä¸€é»ç‹€æ³ ğŸ’¦
        è«‹å†æŠŠã€”API è¤‡è£½é€£çµã€•æˆ–å‚™æ´åœ–åº«è£¡å¦ä¸€å¼µç…§ç‰‡çš„ç¶²å€è²¼å›ä¾†ï¼Œæˆ‘å€‘ç«‹åˆ»å†è©¦ä¸€æ¬¡ï½
